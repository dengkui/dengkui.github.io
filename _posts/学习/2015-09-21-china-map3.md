---
layout: post
title: R语言 map漫谈（三）
category: 学习
tags: 可视化
keywords: R，地图
description: R语言绘制地图详讲
---

在上一篇文章中，我们在地图上展示了各省市的降雨量分布，在这篇文章中，我们尝试着在地图上添加省会城市名称，并展示省会城市的人口，人口数据来自网络，不保证真实准确性，仅用作数据展示示例用。

我们先读入省会城市人口数据，其中，变量名称分别为city,long,lat,popu。long,lat的变量名称不能更改，否则添加文本及散点会出问题。

    popu <- read.csv(file.choose(),head=T)
    popu
           city    long   lat    popu
    1     北 京 116.47 39.90 1067.00
    2     上 海 121.48 31.23 1270.22
    3     天 津 117.18 39.15  752.21
    4     重 庆 106.53 29.53  999.05
    5    哈尔滨 126.68 45.75  311.77
    6     长 春 125.32 43.87  303.94
    7     沈 阳 123.40 41.83  488.66
    8  呼和浩特 111.80 40.82   99.58
    9    石家庄 114.47 38.03  204.96
    10    太 原 112.57 37.87  245.65
    11    济 南 117.00 36.63  303.03
    12    郑 州 113.70 34.80  236.71
    13    西 安 108.90 34.27  497.38
    14    兰 州 103.82 36.05  191.70
    15    银 川 106.27 38.33   69.28
    16    西 宁 101.75 36.63  103.72
    17 乌鲁木齐  87.60 43.80  167.74
    18    合 肥 117.30 31.85  146.50
    19    南 京 118.83 32.03  480.35
    20    杭 州 120.15 30.23  387.01
    21    长 沙 113.00 28.18  188.88
    22    南 昌 115.87 28.68  180.99
    23    武 汉 114.35 30.62  768.10
    24    成 都 104.08 30.65  439.79
    25    贵 阳 106.70 26.58  194.92
    26    福 州 119.30 26.08  157.64
    27    台 北 121.52 25.05  267.60
    28    广 州 113.25 23.13  583.89
    29    海 口 110.33 20.03   60.88
    30    南 宁 108.33 22.80  117.39
    31    昆 明 102.68 25.00  220.04
    32    拉 萨  91.17 29.67   31.14
    33    香 港 114.17 22.30  718.40
    34     澳门 113.50 22.20   54.57

读完数据后，我们就可以在地图上添加文本，这部分功能，用annotate函数也可以实现。
 
    p9 <- p8+geom_text(data=popu,aes(label=city,x=long,y=lat),size=2.5)    #添加省会城市名称
  
接下来，我们用不同颜色代表不同的人口数量规模，人口规模较小时对应白色，而人口数量较大对应红色。当然了，小伙伴可以发挥想象力，自己涂色。
  
    p10 <- p9+geom_point(data=popu,aes(colour=popu))+scale_colour_gradient("人口",high="red",low="white")
    p10  

<div align="center"><img src="http://7xo51k.com1.z0.glb.clouddn.com/maptext.png-wx" ></div>

 这样的图看起来还不是很直观，可以通过设置散点的大小来显示人口的多少，也就是一般的气泡图。
 
    p10 <- p9 + geom_point(data=popu,aes(colour=popu),size=20*popu$popu/max(popu$popu),alpha=0.6)+scale_colour_gradient("人口",high="red",low="white")
    p10

<div align="center"><img src="http://7xo51k.com1.z0.glb.clouddn.com/mapscatter.png-wx" ></div>

看起来，北京，天津，上海，广州，武汉，重庆的人较多，而祖国的大西北和东北多少有些冷清。

## **参考资料**

【1】 [Shapefile格式说明]( http://blog.csdn.net/cleverysm/article/details/2114006)

【2】 [R绘制中国地图，并展示流行病学数据](http://cos.name/2014/08/r-maps-for-china/)

【3】 [ 用R画有图例的中国地图 ]( http://blog.csdn.net/lichangzai/article/details/40856543)

【4】 ggplot2:数据处理与图形艺术